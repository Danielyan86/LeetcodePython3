# 227. Basic Calculator II

## 题目难点

这道题的核心难点在于：**需要维护过去的状态，通过上一个运算符来决定当前操作**
一个符号寄存器
一个加法
一个乘法

加法和减法是一类
只是减法要把当前number置换成负数
乘除法是一类

## 关键要点

### 1. 数字转换和空格处理（相对简单）
- 多位数字的构建：`num = num * 10 + int(char)`
- 空格跳过：`if char == ' ': continue`

### 2. 运算符处理（重点难点）

**最容易混淆的地方：我们处理的是上一个运算符，不是当前运算符！**

前后都加上哨兵

计算时候是在当前是符号，但是不是根据当前符号，是根据上一个！！
加号不用说了，最直接
减号说明下一草计算是减法，为了把减法统一换成加法，给当前存的数字加上一个负号

如果上一个是乘号，就要拉上当前符号，result不更新

```python

class Solution:
    def calculate(self, s: str) -> int:
        res, cur, num = 0, 0, 0
        sign='+'

        for char in s+'+':
            if char == ' ': continue
            if char.isdigit():
                num = num*10 + int(char)
                continue  
            if sign == "+":
                res = res + cur
                cur = num
            elif sign == "-":
                res = res + cur
                cur = 0-num
            elif sign == "*":
                cur = cur*num
            elif sign == "/":
                cur = int(cur/num)
            sign = char
            num = 0


        return res+ cur
```